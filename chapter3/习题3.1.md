
## Content

### 习题 3.1

令 A, B, C 是定义在域 F 上的 n×n 矩阵。在第 2.2 节中，我们介绍了一种用于检查 C = A·B 的随机算法。该算法选择一个随机的域元素 r，令 x = (r, r^2, ..., r^n)，如果 Cx = A · (Bx)，则输出 EQUAL，否则输出 NOT-EQUAL。现在假设向量 x 的每个元素都是独立地从域 F 中均匀随机选择的。证明以下结论：

• 如果对于所有 i = 1,...,n 和 j = 1,...,n，都有 Ci j = (AB)i j，则无论如何选择 x，算法都会输出 EQUAL。

• 如果存在至少一个 (i, j) ∈ [n]×[n]，使得 Ci j ≠ (AB)i j，则算法输出 NOT-EQUAL 的概率至少为 1 - 1/|F|。



证明

（1）： 已知对于所有 i = 1,...,n 和 j = 1,...,n，都有 Ci j = (AB)i j， 那么对于Cx = A · (Bx)  可转换为 (AB)x = A(Bx)。 又由于矩阵运算满足结合率，既 (AB)x = A(Bx). 移项后有（AB-AB)x = 0。 因此对于任意x，都有Cij = (AB)ij, 所以无论如何选择 x，算法都会输出 EQUAL。


（2）：
该证明需要结合Schwartz-Zippel lemma: 条件假设存在至少一个 (i, j) ∈ [n]×[n]，使得 Ci j ≠ (AB)i j，也就意味着Cx ，(AB）x两个列向量（元素为多项式）中对应位置至少有一个不相等。那么我们计算出的该处不相等的概率，就是最小概率。  由于题目说明向量 x 的每个元素都是独立地从域 F 中均匀随机选择的，因此列向量中每个元素是多线性多项式，由于该多项式中每项只有一个变量，因此整个多项式最高阶最多为1. 那么根据Schwartz-Zippel lemma，可知： 对于在F上的，两个n变量的，阶最大为1的多项式CiX = (AB)iX，最多有 1/｜F｜比例的输入。 也就是说，算法输出NOT-EQUAL的概率，最少是 1-1/｜F｜. 



